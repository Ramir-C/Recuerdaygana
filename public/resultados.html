<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Juego - Resultados</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #f4f4f4; }
  </style>
</head>
<body>
  <h1>Juego - Guardar y Ver Resultados</h1>

  <button onclick="guardarResultado()">Guardar Resultado</button>
  <button onclick="cargarResultados()">Cargar Resultados</button>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Intento</th>
        <th>Tiempo</th>
        <th>Errores</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody id="tabla-resultados"></tbody>
  </table>

  <script>
    // 📌 Guardar un resultado de prueba
    async function guardarResultado() {
      const gameData = {
        nombre: "Jugador Demo",
        intento: Math.floor(Math.random() * 5) + 1,
        tiempo: (Math.random() * 60).toFixed(2),
        errores: Math.floor(Math.random() * 3)
      };

      const res = await fetch("/api/resultados", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(gameData)
      });

      const data = await res.json();
      if (data.success) {
        alert("✅ Resultado guardado con ID " + data.id);
        cargarResultados(); // refrescar tabla
      } else {
        alert("❌ Error: " + data.error);
      }
    }

    // 📌 Cargar resultados en la tabla
    async function cargarResultados() {
      const res = await fetch("/api/resultados");
      const resultados = await res.json();

      const tabla = document.getElementById("tabla-resultados");
      tabla.innerHTML = "";

      resultados.forEach(r => {
        const fila = `
          <tr>
            <td>${r.id}</td>
            <td>${r.nombre}</td>
            <td>${r.intento}</td>
            <td>${r.tiempo}</td>
            <td>${r.errores}</td>
            <td>${r.fecha}</td>
          </tr>
        `;
        tabla.innerHTML += fila;
      });
    }

    // 📌 Cargar al iniciar
    cargarResultados();
  </script>
</body>
</html>

